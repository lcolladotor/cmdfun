---
title: "dotargs"
output: github_document
---

<!-- badges: start -->
[![Lifecycle: maturing](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)
<!-- badges: end -->

## A simple framework for building shell interfaces

`dotargs` provides two main functions: `getDots` and `dotsToArgs` which can act
as a useful backend for converting keyword arguments passed to ... in a function
call into a vector of shell command flags which can be passed to `system2` or
`processx`. Together, they can be used to build user-friendly R interfaces to
shell programs with several options which need to be exposed to the user.



## Install
```{r, eval=F}
remotes::install_github("snystrom/dotargs")
```

## Examples
```{r}
library(magrittr)
library(dotargs)

shellCut <- function(text, ...){

  args <- getDotArgs() %>%
    argsToFlags()

	system2("echo", c(text, "|", "cut", args))

}
```

```{r}
shellCut("hello_world", f = 2, d = "_") 
```
```{r, echo=F}
cat("world")
```

Multiple values can be passed to arguments using vectors
```{r}
shellCut("hello_world_hello", f = c(1,3), d = "_") 
```

```{r, echo=F}
cat("hello_hello")
```

**WARNING:** It's still possible to do unsafe operations as follows:
```{r}
shellCut("hello_world", f = 2, d = "_ && echo test")
```

```{r, echo=F}
cat("world")
cat("test")
```

### Boolean flags are passed as bool operators
```{r}
shell_ls <- function(dir = ".", ...){
  args <- getDotArgs() %>% 
    argsToFlags()
  
  system2("ls", c(dir, args))
}
```

```{r}
shell_ls("R")
```
```{r, echo=F}
cat("dots_to_args.R\nutils.R")
```

```{r}
shell_ls("R", l = T)
```

```{r, echo=F}
cat("total 8\n")
cat("-rw-r--r-- 1 snystrom employee 1372 Mar 25 12:00 dots_to_args.R\n")
cat("-rw-r--r-- 1 snystrom employee 1372 Mar 25 12:00 utils.R")
```

### Named vectors can be used to provide user-friendly aliases for single-letter flags
```{r}

shell_ls_alias <- function(dir = ".", ...){
  
  argsDict <- c("long" = "l")
  
  args <- getDotArgs() %>% 
    argsToFlags(argsDict)
  
  system2("ls", c(dir, args))
}
```

```{r}
shell_ls_alias("R", long = T)
```
```{r, echo=F}
cat("total 4\n")
cat("-rw-r--r-- 1 snystrom employee 1372 Mar 25 11:22 dots_to_args.R")
```

```{r}
shellCut_alias <- function(text, ...){

  argsDict <- c("sep" = "d")
    
	args <- getDotArgs() %>%
		argsToFlags(argsDict)

	system2("echo", c(text, "|", "cut", args))
}
```

```{r}
shellCut_alias("hello_world", f = 2, sep = "_") 
```
```{r, echo=F}
cat("world")
```

