<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Framework for Building Interfaces to Shell Commands • cmdfun</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Framework for Building Interfaces to Shell Commands">
<meta property="og:description" content="Writing interfaces to commandline software is cumbersome. 
    cmdfun provides a framework for building function calls to seemlessly 
    interface with shell commands by allowing lazy evaluation of commandline arguments. 
    cmdfun also provides methods for handling user-specific paths to tool installs or secrets like API keys. 
    Its focus is to equally serve package builders who wish to wrap commandline software, and to help analysts stay inside 
    R when they might usually leave to execute non-R software.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">cmdfun</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.1.91.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/cmdfun.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/snystrom/cmdfun/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="cmdfun" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#cmdfun" class="anchor"></a>cmdfun</h1></div>
<!-- badges: start -->

<div id="a-simple-framework-for-building-shell-interfaces" class="section level2">
<h2 class="hasAnchor">
<a href="#a-simple-framework-for-building-shell-interfaces" class="anchor"></a>A simple framework for building shell interfaces</h2>
<p>The purpose of <code>cmdfun</code> is to significantly reduce the overhead involved in wrapping shell programs in R. The tools are intended to be intuitive and lightweight enough to use for data scientists trying to get things done quickly, but robust and full-fledged enough for developers to extend them to more advanced use cases.</p>
</div>
<div id="vocabulary-to-describe-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#vocabulary-to-describe-operations" class="anchor"></a>Vocabulary to describe operations</h2>
<p>Briefly, <code>cmdfun</code> captures R function arguments (<strong>args</strong>) and converts them to a vector of commandline <strong>flags</strong>.</p>
<p>The <code>cmdfun</code> framework provides three mechanisms for capturing function arguments:</p>
<ul>
<li>
<code><a href="reference/cmd_args_dots.html">cmd_args_dots()</a></code> captures all arguments passed to <code>...</code>
</li>
<li>
<code><a href="reference/cmd_args_named.html">cmd_args_named()</a></code> captures all keyword arguments defined by the user</li>
<li>
<code><a href="reference/cmd_args_all.html">cmd_args_all()</a></code> captures both named + dot arguments</li>
</ul>
<p><code>cmd_list_interp</code> converts the captured arguments to a parsed list of flag/value pairs. This output can be useful for additonal handling of special flag assignments from within R.</p>
<p><code>cmd_list_to_flags</code> converts the output of <code>cmd_list_interp</code> to a vector of commandline-style flags. This output can be directly fed to <code>system2</code> or <code>processx</code>.</p>
<p>Together, they can be used to build user-friendly R interfaces to shell programs without having to manually implement all commandline flags in R functions.</p>
</div>
<div id="install" class="section level2">
<h2 class="hasAnchor">
<a href="#install" class="anchor"></a>Install</h2>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># To install the development version from github</span>
<span class="kw pkg">remotes</span><span class="kw ns">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"snystrom/cmdfun"</span>)</pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">cmdfun</span>)</pre></div>
<p>variables defined in <code>...</code> are converted to character vector of flags appropriate for shell commands.</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">myFunction</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">...</span>){

  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>()

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">flags</span>)
}</pre></div>
<div class="sourceCode" id="cb4"><pre class="r">(<span class="no">flagsList</span> <span class="kw">&lt;-</span> <span class="fu">myFunction</span>(<span class="kw">flag</span> <span class="kw">=</span> <span class="st">"var"</span>, <span class="kw">bool_flag</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## $flag</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">## [1] "var"</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">## </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">## $bool_flag</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">## [1] ""</span></span></code></pre></div>
<p>This list can be passed to <code>cmd_list_to_flags</code> to generate a vector suitable for <code>system2</code> to build shell commands.</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">flagsList</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()</pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## [1] "-flag"      "var"        "-bool_flag"</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">shellCut</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">text</span>, <span class="no">...</span>){

  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

    <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"cut"</span>, <span class="no">flags</span>, <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">input</span> <span class="kw">=</span> <span class="no">text</span>)

}</pre></div>
<div class="sourceCode" id="cb9"><pre class="r"><span class="fu">shellCut</span>(<span class="st">"hello_world"</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">d</span> <span class="kw">=</span> <span class="st">"_"</span>)</pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">## [1] "world"</span></span></code></pre></div>
<p>Multiple values can be passed to arguments using vectors</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="fu">shellCut</span>(<span class="st">"hello_world_hello"</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">3</span>), <span class="kw">d</span> <span class="kw">=</span> <span class="st">"_"</span>)</pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## [1] "hello_hello"</span></span></code></pre></div>
<div id="boolean-flags-are-passed-as-bool-operators" class="section level3">
<h3 class="hasAnchor">
<a href="#boolean-flags-are-passed-as-bool-operators" class="anchor"></a>Boolean flags are passed as bool operators</h3>
<div class="sourceCode" id="cb13"><pre class="r"><span class="no">shell_ls</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">dir</span> <span class="kw">=</span> <span class="st">"."</span>, <span class="no">...</span>){
  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

  <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"ls"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">dir</span>, <span class="no">flags</span>), <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>)
}</pre></div>
<div class="sourceCode" id="cb14"><pre class="r"><span class="fu">shell_ls</span>(<span class="st">"R"</span>)</pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">## [1] "cmd_args.R"       "macros.R"         "parse_help.R"     "utils.R"         </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">## [5] "utils_internal.R"</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="r"><span class="fu">shell_ls</span>(<span class="st">"R"</span>, <span class="kw">l</span> <span class="kw">=</span> <span class="no">T</span>)</pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">## [1] "total 52"                                                                  </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">## [2] "-rw-r--r-- 1 snystrom its_employee_psx  6273 Aug 21 09:38 cmd_args.R"      </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">## [3] "-rw-r--r-- 1 snystrom its_employee_psx 11354 Aug 21 09:38 macros.R"        </span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">## [4] "-rw-r--r-- 1 snystrom its_employee_psx  6264 Aug 21 10:43 parse_help.R"    </span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">## [5] "-rw-r--r-- 1 snystrom its_employee_psx 13448 Aug 21 09:38 utils.R"         </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">## [6] "-rw-r--r-- 1 snystrom its_employee_psx  7390 Aug 21 09:32 utils_internal.R"</span></span></code></pre></div>
</div>
<div id="named-vectors-can-be-used-to-provide-user-friendly-aliases-for-single-letter-flags" class="section level3">
<h3 class="hasAnchor">
<a href="#named-vectors-can-be-used-to-provide-user-friendly-aliases-for-single-letter-flags" class="anchor"></a>Named vectors can be used to provide user-friendly aliases for single-letter flags</h3>
<div class="sourceCode" id="cb18"><pre class="r"><span class="no">shell_ls_alias</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">dir</span> <span class="kw">=</span> <span class="st">"."</span>, <span class="no">...</span>){

  <span class="no">argsDict</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"long"</span> <span class="kw">=</span> <span class="st">"l"</span>)

  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>(<span class="no">argsDict</span>) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

  <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"ls"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">dir</span>, <span class="no">flags</span>), <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>)
}</pre></div>
<div class="sourceCode" id="cb19"><pre class="r"><span class="fu">shell_ls_alias</span>(<span class="st">"R"</span>, <span class="kw">long</span> <span class="kw">=</span> <span class="no">T</span>)</pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">## [1] "total 52"                                                                  </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">## [2] "-rw-r--r-- 1 snystrom its_employee_psx  6273 Aug 21 09:38 cmd_args.R"      </span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">## [3] "-rw-r--r-- 1 snystrom its_employee_psx 11354 Aug 21 09:38 macros.R"        </span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">## [4] "-rw-r--r-- 1 snystrom its_employee_psx  6264 Aug 21 10:43 parse_help.R"    </span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">## [5] "-rw-r--r-- 1 snystrom its_employee_psx 13448 Aug 21 09:38 utils.R"         </span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">## [6] "-rw-r--r-- 1 snystrom its_employee_psx  7390 Aug 21 09:32 utils_internal.R"</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="r"><span class="no">shellCut_alias</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">text</span>, <span class="no">...</span>){

  <span class="no">argsDict</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"sep"</span> <span class="kw">=</span> <span class="st">"d"</span>,
                <span class="st">"fields"</span> <span class="kw">=</span> <span class="st">"f"</span>)

    <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
        <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>(<span class="no">argsDict</span>) <span class="kw">%&gt;%</span>
      <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

    <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"cut"</span>, <span class="no">flags</span>, <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>, <span class="kw">input</span> <span class="kw">=</span> <span class="no">text</span>)
}</pre></div>
<div class="sourceCode" id="cb22"><pre class="r"><span class="fu">shellCut_alias</span>(<span class="st">"hello_world"</span>, <span class="kw">fields</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"_"</span>)</pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">## [1] "world"</span></span></code></pre></div>
</div>
</div>
<div id="abstraction-of-command-path-handling" class="section level2">
<h2 class="hasAnchor">
<a href="#abstraction-of-command-path-handling" class="anchor"></a>Abstraction of command path handling</h2>
<p>A common pattern when designing shell interfaces is to ask the user to give an absolute path to the target shell utility. It is common to pass this information from the user to R by using either R environment variables defined in <code>.Renviron</code>, using options (set with <code><a href="https://rdrr.io/r/base/options.html">option()</a></code>, and got with <code><a href="https://rdrr.io/r/base/options.html">getOption()</a></code>), having the user explicitly pass the path in the function call, or failing this, using a default install path.</p>
<p><code><a href="reference/cmd_path_search.html">cmd_path_search()</a></code> is a macro which returns a function that returns a valid path to the target by heirarchically searching a series of possible locations.</p>
<p>For example, to build an interface to the “MEME” suite, which is by default installed to <code>~/meme/bin</code>, one could build the following:</p>
<div class="sourceCode" id="cb24"><pre class="r"><span class="no">search_meme_path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_path_search.html">cmd_path_search</a></span>(<span class="kw">default_path</span> <span class="kw">=</span> <span class="st">"~/meme/bin"</span>)

<span class="fu">search_meme_path</span>()</pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co">## [1] "/nas/longleaf/home/snystrom/meme/bin"</span></span></code></pre></div>
<p>To only search the R environment variable “MEME_PATH”, one could build:</p>
<div class="sourceCode" id="cb26"><pre class="r"><span class="no">search_meme_path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_path_search.html">cmd_path_search</a></span>(<span class="kw">environment_var</span> <span class="kw">=</span> <span class="st">"MEME_PATH"</span>)</pre></div>
<div class="sourceCode" id="cb27"><pre class="r"><span class="co"># Without environment variable defined</span>
<span class="fu">search_meme_path</span>()</pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">## Error in search_meme_path(): No path defined or detected</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="r"><span class="co"># With environment varialbe defined</span>
<span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span>(<span class="st">"MEME_PATH"</span> <span class="kw">=</span> <span class="st">"~/meme/bin"</span>)
<span class="fu">search_meme_path</span>()</pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co">## [1] "/nas/longleaf/home/snystrom/meme/bin"</span></span></code></pre></div>
<p>Multiple arguments can be used, and they will be searched from most-specific, to most-general.</p>
<div class="sourceCode" id="cb31"><pre class="r"><span class="no">search_meme_path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_path_search.html">cmd_path_search</a></span>(<span class="kw">environment_var</span> <span class="kw">=</span> <span class="st">"MEME_PATH"</span>,
                                       <span class="kw">default_path</span> <span class="kw">=</span> <span class="st">"~/meme/bin"</span>)</pre></div>
<p>For example, if “MEME_PATH” is invalid on my machine, the search_function will return the default path as long as the default is also valid on my machine.</p>
<div class="sourceCode" id="cb32"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span>(<span class="st">"MEME_PATH"</span> <span class="kw">=</span> <span class="st">"bad/path"</span>)
<span class="fu">search_meme_path</span>()</pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co">## [1] "/nas/longleaf/home/snystrom/meme/bin"</span></span></code></pre></div>
<div id="support-for-tool-utilities" class="section level3">
<h3 class="hasAnchor">
<a href="#support-for-tool-utilities" class="anchor"></a>Support for tool utilities</h3>
<p>Some software, like the MEME suite is distributed as several binaries located in a common directory. To allow interface builders to officially support specific binaries, each binary can be defined as a “utility” within the build path.</p>
<p>Here, I will include two tools from the MEME suite, AME, and DREME (distributed as binaries named “ame”, and “dreme”).</p>
<div class="sourceCode" id="cb34"><pre class="r"><span class="no">search_meme_path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_path_search.html">cmd_path_search</a></span>(<span class="kw">environment_var</span> <span class="kw">=</span> <span class="st">"MEME_PATH"</span>,
                                       <span class="kw">default_path</span> <span class="kw">=</span> <span class="st">"~/meme/bin"</span>,
                                       <span class="kw">utils</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dreme"</span>, <span class="st">"ame"</span>))</pre></div>
<p>search_function functions have two optional arguments: <code>path</code> and <code>util</code>. <code>path</code> acts as an override to the defaults provided when building the search_function. User-provided path variables will always be used instead of provided defaults. This is to catch problems from the user and not cause unexpected user-level behavior.</p>
<div class="sourceCode" id="cb35"><pre class="r"><span class="fu">search_meme_path</span>(<span class="st">"bad/path"</span>)</pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">## Error in .check_valid_command_path(path): Command: bad/path, does not exist.</span></span></code></pre></div>
<p><code>util</code> specifies which utility path to return (if any). The path search_function will throw an error if the utility is not found in any of the specified locations.</p>
<div class="sourceCode" id="cb37"><pre class="r"><span class="fu">search_meme_path</span>(<span class="kw">util</span> <span class="kw">=</span> <span class="st">"dreme"</span>)</pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">## [1] "/nas/longleaf/home/snystrom/meme/bin/dreme"</span></span></code></pre></div>
<p>List all utility paths (but don’t check if they’re valid). Useful for writing user-facing install checking functions.</p>
<div class="sourceCode" id="cb39"><pre class="r"><span class="fu">search_meme_path</span>(<span class="kw">util</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">## [1] "/nas/longleaf/home/snystrom/meme/bin/dreme"</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">## [2] "/nas/longleaf/home/snystrom/meme/bin/ame"</span></span></code></pre></div>
<p><code>cmdfun</code> provides a preexisting utility for this, however. The <code>cmd_install_check</code> function can be lightly wrapped by package builders to verify and print a user-friendly series of checks for a valid tool install. it takes as input the output of <code>build_package_search_function</code> and an optional user-override <code>path</code>.</p>
<p>Here I build a function for checking a users <code>meme</code> install.</p>
<div class="sourceCode" id="cb41"><pre class="r"><span class="no">check_meme_install</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">path</span> <span class="kw">=</span> <span class="kw">NULL</span>){
  <span class="fu"><a href="reference/cmd_install_check.html">cmd_install_check</a></span>(<span class="no">search_meme_path</span>, <span class="kw">path</span> <span class="kw">=</span> <span class="no">path</span>)
}</pre></div>
<div class="sourceCode" id="cb42"><pre class="r"><span class="co"># searches default meme search locations</span>
<span class="fu">check_meme_install</span>()</pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co">## checking main install</span></span>
<span id="cb43-2"><a href="#cb43-2"></a></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="co">## ✓ /nas/longleaf/home/snystrom/meme/bin</span></span>
<span id="cb43-4"><a href="#cb43-4"></a></span>
<span id="cb43-5"><a href="#cb43-5"></a><span class="co">## checking util installs</span></span>
<span id="cb43-6"><a href="#cb43-6"></a></span>
<span id="cb43-7"><a href="#cb43-7"></a><span class="co">## ✓ /nas/longleaf/home/snystrom/meme/bin/dreme</span></span>
<span id="cb43-8"><a href="#cb43-8"></a></span>
<span id="cb43-9"><a href="#cb43-9"></a><span class="co">## ✓ /nas/longleaf/home/snystrom/meme/bin/ame</span></span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="r"><span class="co"># uses user override</span>
<span class="fu">check_meme_install</span>(<span class="st">'bad/path'</span>)</pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co">## checking main install</span></span>
<span id="cb45-2"><a href="#cb45-2"></a></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="co">## x bad/path</span></span></code></pre></div>
<p>If you want to write your own install checker instead of using the <code>cmd_install_check</code> function, <code>cmdfun</code> also provides the <code>cmd_ui_file_exists</code> function for printing pretty status messages.</p>
<div class="sourceCode" id="cb46"><pre class="r"><span class="fu"><a href="reference/cmd_ui_file_exists.html">cmd_ui_file_exists</a></span>(<span class="st">"bad/file"</span>)</pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">## x bad/file</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="r"><span class="fu"><a href="reference/cmd_ui_file_exists.html">cmd_ui_file_exists</a></span>(<span class="st">"~/meme/bin"</span>)</pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co">## ✓ ~/meme/bin</span></span></code></pre></div>
</div>
<div id="internal-install-validators" class="section level3">
<h3 class="hasAnchor">
<a href="#internal-install-validators" class="anchor"></a>Internal install validators</h3>
<p><code>cmdfun</code> also provides a macro <code><a href="reference/cmd_install_is_valid.html">cmd_install_is_valid()</a></code> to construct functions returning boolean values testing for an install path. These are useful in function logic, or package development for setting conditional examples or function hooks that depend on a command install. <code><a href="reference/cmd_install_is_valid.html">cmd_install_is_valid()</a></code> takes a path search_function function as input, so any <code>options</code>, <code>.Renviron</code>, or default install location logic propagates to these funtions as well.</p>
<div class="sourceCode" id="cb50"><pre class="r"><span class="no">meme_installed</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_install_is_valid.html">cmd_install_is_valid</a></span>(<span class="no">search_meme_path</span>)
<span class="fu">meme_installed</span>()</pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">## [1] TRUE</span></span></code></pre></div>
<p>This also works on utils defined during path hanlder construction.</p>
<div class="sourceCode" id="cb52"><pre class="r"><span class="no">ame_installed</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_install_is_valid.html">cmd_install_is_valid</a></span>(<span class="no">search_meme_path</span>, <span class="kw">util</span> <span class="kw">=</span> <span class="st">"ame"</span>)
<span class="fu">ame_installed</span>()</pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co">## [1] TRUE</span></span></code></pre></div>
</div>
</div>
<div id="bringing-it-all-together" class="section level2">
<h2 class="hasAnchor">
<a href="#bringing-it-all-together" class="anchor"></a>Bringing it all together</h2>
<p>Using a <code>cmd_args_</code> family function to get and convert function arguments to commandline flags. The path search_function returns the correct <code>command</code> call which can be passed to <code>system2</code> or <code>processx</code> along with the flags generated from <code>cmd_list_interp</code>.</p>
<p>This makes for a robust shell wrapper without excess overhead.</p>
<p>In the <code>runDreme</code> function below, the user can pass any valid <code>dreme</code> argument using the rules for command args defined above to <code>...</code>. Allowing <code>meme_path</code> as a function argument and passing it to <code>search_meme_path</code> allows the user to override the default search path which is: <code>MEME_PATH</code> environment variable, followed by the <code>~/meme/bin</code> default install.</p>
<div class="sourceCode" id="cb54"><pre class="r"><span class="no">search_meme_path</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_path_search.html">cmd_path_search</a></span>(<span class="kw">environment_var</span> <span class="kw">=</span> <span class="st">"MEME_PATH"</span>,
                                       <span class="kw">default_path</span> <span class="kw">=</span> <span class="st">"~/meme/bin"</span>,
                                       <span class="kw">utils</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"dreme"</span>, <span class="st">"ame"</span>))

<span class="no">runDreme</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">...</span>, <span class="no">meme_path</span> <span class="kw">=</span> <span class="kw">NULL</span>){
  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

  <span class="no">command</span> <span class="kw">&lt;-</span> <span class="fu">search_meme_path</span>(<span class="kw">path</span> <span class="kw">=</span> <span class="no">meme_path</span>, <span class="kw">util</span> <span class="kw">=</span> <span class="st">"dreme"</span>)

  <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="no">command</span>, <span class="no">flags</span>)
}</pre></div>
<p>Commands can now run through <code>runDreme</code> by passing flags as function arguments.</p>
<div class="sourceCode" id="cb55"><pre class="r"><span class="fu">runDreme</span>(<span class="kw">h</span> <span class="kw">=</span> <span class="no">T</span>)</pre></div>
<p>If users have issues with the install, they can run <code>check_meme_install()</code> to verify the tools are being detected by R.</p>
</div>
<div id="restrict-argument-matching" class="section level2">
<h2 class="hasAnchor">
<a href="#restrict-argument-matching" class="anchor"></a>Restrict argument matching</h2>
<p>each <code>cmd_args_</code> family function accepts a character vector of names to <code>keep</code> or <code>drop</code> arguments which will restrict command argument matches to values in <code>keep</code> (or ignore those in <code>drop</code>). As of now, <code>keep</code> and <code>drop</code> are mutually exclusive.</p>
<p>This can be useful to allow only some function arguments to be captured as flags, while others can be used for function logic.</p>
<div class="sourceCode" id="cb56"><pre class="r"><span class="no">myFunction</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">arg1</span>, <span class="no">arg2</span>, <span class="no">print</span> <span class="kw">=</span> <span class="no">T</span>){
  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_named.html">cmd_args_named</a></span>(<span class="kw">keep</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"arg1"</span>, <span class="st">"arg2"</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">print</span>, <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"printing"</span>), <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"nothing"</span>))

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">flags</span>)
}

<span class="fu">myFunction</span>(<span class="kw">arg1</span> <span class="kw">=</span> <span class="st">"blah"</span>, <span class="kw">arg2</span> <span class="kw">=</span> <span class="st">"blah"</span>)</pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="co">## [1] "printing"</span></span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co">## [1] "-arg1" "blah"  "-arg2" "blah"</span></span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="r"><span class="fu">myFunction</span>(<span class="kw">arg1</span> <span class="kw">=</span> <span class="st">"blah"</span>, <span class="kw">arg2</span> <span class="kw">=</span> <span class="st">"blah"</span>, <span class="no">F</span>)</pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="co">## [1] "nothing"</span></span>
<span id="cb59-2"><a href="#cb59-2"></a></span>
<span id="cb59-3"><a href="#cb59-3"></a><span class="co">## [1] "-arg1" "blah"  "-arg2" "blah"</span></span></code></pre></div>
</div>
<div id="manupulating-flag-list-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#manupulating-flag-list-objects" class="anchor"></a>Manupulating flag list objects</h2>
<p>For the most part, the <a href="https://purrr.tidyverse.org/">purrr</a> library is the most useful toolkit for operations on list objects.</p>
<p><code>cmdfun</code> provides additional helper functions to handle common manipulations.</p>
<p><code>cmd_list_drop</code> operates on flag lists to drop all entries corresponding to a certain name, specific name/value pairs, or by index position. Can be useful for ignoring setting certain flags if the user set them to a specific value. Conversely, <code>cmd_list_keep</code> functions identically but for keeping entries.</p>
<div class="sourceCode" id="cb60"><pre class="r"><span class="no">myFunction</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">arg1</span>, <span class="no">arg2</span>){
  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_named.html">cmd_args_named</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_drop.html">cmd_list_drop</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"arg2"</span> <span class="kw">=</span> <span class="st">"baz"</span>)) <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

  <span class="fu"><a href="https://rdrr.io/r/base/function.html">return</a></span>(<span class="no">flags</span>)
}

<span class="fu">myFunction</span>(<span class="kw">arg1</span> <span class="kw">=</span> <span class="st">"foo"</span>, <span class="kw">arg2</span> <span class="kw">=</span> <span class="st">"bar"</span>)</pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="co">## [1] "-arg1" "foo"   "-arg2" "bar"</span></span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="r"><span class="fu">myFunction</span>(<span class="kw">arg1</span> <span class="kw">=</span> <span class="st">"foo"</span>, <span class="kw">arg2</span> <span class="kw">=</span> <span class="st">"baz"</span>)</pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co">## [1] "-arg1" "foo"</span></span></code></pre></div>
</div>
<div id="expecting-output-files" class="section level2">
<h2 class="hasAnchor">
<a href="#expecting-output-files" class="anchor"></a>Expecting output files</h2>
<p>Sometimes a commandline function returns multiple output files you want to check for after the run.</p>
<p><code>cmd_error_if_missing</code> accepts a vector or list of files &amp; checks that they exist.</p>
<p><code>cmdfun</code> additionally provides a few convenience functions for generating lists of expected files. <code>cmd_file_combn</code> generates combinations of extension/prefix file names. The output can be passed to <code>cmd_error_if_missing</code> which will error if a file isn’t found on the filesystem.</p>
<div class="sourceCode" id="cb64"><pre class="r"><span class="fu"><a href="reference/cmd_file_combn.html">cmd_file_combn</a></span>(<span class="kw">ext</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"txt"</span>, <span class="st">"xml"</span>), <span class="kw">prefix</span> <span class="kw">=</span> <span class="st">"outFile"</span>)</pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co">## $txt</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co">## [1] "./outFile.txt"</span></span>
<span id="cb65-3"><a href="#cb65-3"></a><span class="co">## </span></span>
<span id="cb65-4"><a href="#cb65-4"></a><span class="co">## $xml</span></span>
<span id="cb65-5"><a href="#cb65-5"></a><span class="co">## [1] "./outFile.xml"</span></span></code></pre></div>
<div class="sourceCode" id="cb66"><pre class="r"><span class="fu"><a href="reference/cmd_file_combn.html">cmd_file_combn</a></span>(<span class="kw">ext</span> <span class="kw">=</span> <span class="st">"txt"</span>, <span class="kw">prefix</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"outFile"</span>, <span class="st">"outFile2"</span>, <span class="st">"outFile3"</span>))</pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co">## $outFile</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co">## [1] "./outFile.txt"</span></span>
<span id="cb67-3"><a href="#cb67-3"></a><span class="co">## </span></span>
<span id="cb67-4"><a href="#cb67-4"></a><span class="co">## $outFile2</span></span>
<span id="cb67-5"><a href="#cb67-5"></a><span class="co">## [1] "./outFile2.txt"</span></span>
<span id="cb67-6"><a href="#cb67-6"></a><span class="co">## </span></span>
<span id="cb67-7"><a href="#cb67-7"></a><span class="co">## $outFile3</span></span>
<span id="cb67-8"><a href="#cb67-8"></a><span class="co">## [1] "./outFile3.txt"</span></span></code></pre></div>
</div>
<div id="error-checking-user-input" class="section level2">
<h2 class="hasAnchor">
<a href="#error-checking-user-input" class="anchor"></a>Error checking user input</h2>
<p>When using <code>cmdfun</code> to write lazy shell wrappers, the user can easily mistype a commandline flag since there is not text completion. Some programs behave unexpectedly when flags are typed incorrectly, and for this reason return uninformative error messages. <code>cmdfun</code> has built-in methods to automatically populate a list of valid flags from a command’s help-text.</p>
<p>Alternatively, package builders could pass a vector of allowed flag names to check against if they didn’t want to parse help text. The goal is maximum flexibility.</p>
<p>The following example demonstrates how to parse help text (in this case from <code>tar</code>) into a vector of allowed flags. This vector is compared to the user-input flags (<code>user_input_flags</code> below), and tries to identify misspelled function arguments.</p>
<p>Here, the user has accidentally used the argument <code>delte</code> instead of <code>delete</code>. <code>cmdfun</code> tries to be helpful and identify the misspelling for the user.</p>
<div class="sourceCode" id="cb68"><pre class="r"><span class="no">user_input_flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"delte"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"tar"</span>, <span class="st">"--help"</span>, <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/cmd_help_parse_flags.html">cmd_help_parse_flags</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span>(<span class="st">","</span>, <span class="st">""</span>, <span class="no">.</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Compares User-input flags to parsed commandline flags</span>
  <span class="co"># returns flags that match based on edit distance</span>
  <span class="fu"><a href="reference/cmd_help_flags_similar.html">cmd_help_flags_similar</a></span>(<span class="no">user_input_flags</span>) <span class="kw">%&gt;%</span>
  <span class="co"># Prints error message suggesting the most similar flag name</span>
  <span class="fu"><a href="reference/cmd_help_flags_suggest.html">cmd_help_flags_suggest</a></span>()</pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="co">## Error: Invalid flags. Did you mean:</span></span>
<span id="cb69-2"><a href="#cb69-2"></a><span class="co">## "delete" instead of: "delte"</span></span></code></pre></div>
</div>
<div id="unsafe-operations" class="section level2">
<h2 class="hasAnchor">
<a href="#unsafe-operations" class="anchor"></a>Unsafe operations</h2>
<p><strong>WARNING:</strong> It’s still possible to do unsafe operations as follows, so please be careful how you build system calls.</p>
<div class="sourceCode" id="cb70"><pre class="r"><span class="no">shellCut_unsafe</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">text</span>, <span class="no">...</span>){

  <span class="no">flags</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cmd_args_dots.html">cmd_args_dots</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_interp.html">cmd_list_interp</a></span>() <span class="kw">%&gt;%</span>
    <span class="fu"><a href="reference/cmd_list_to_flags.html">cmd_list_to_flags</a></span>()

    <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span>(<span class="st">"echo"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">text</span> , <span class="st">"|"</span>, <span class="st">"cut"</span>, <span class="no">flags</span>), <span class="kw">stdout</span> <span class="kw">=</span> <span class="no">T</span>)

}

<span class="fu">shellCut_unsafe</span>(<span class="st">"hello_world"</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">d</span> <span class="kw">=</span> <span class="st">"_ &amp;&amp; echo test"</span>)</pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co">## [1] "world" "test"</span></span></code></pre></div>
<p><strong>NOTE</strong> even if when setting <code>stdout = TRUE</code> the second command doesn’t appear in the output, it will still have run.</p>
<p>A more extreme example of what can happen is here, where <code>~/deleteme.txt</code> will be removed silently.</p>
<p>I promise I’ll get around to sanitizing user input eventually.</p>
<div class="sourceCode" id="cb72"><pre class="r"><span class="fu">shellCut</span>(<span class="st">"hello_world"</span>, <span class="kw">f</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">d</span> <span class="kw">=</span> <span class="st">"_ &amp;&amp; rm ~/deleteme.txt"</span>)</pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/snystrom/cmdfun/">https://​github.com/​snystrom/​cmdfun/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/snystrom/cmdfun">https://​github.com/​snystrom/​cmdfun</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Spencer Nystrom <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0000-0003-1000-1579" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/snystrom/cmdfun/actions"><img src="https://github.com/snystrom/cmdfun/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://codecov.io/gh/snystrom/cmdfun?branch=master"><img src="https://codecov.io/gh/snystrom/cmdfun/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Spencer Nystrom.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
